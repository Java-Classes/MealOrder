<!--
  ~ Copyright 2018, TeamDev Ltd. All rights reserved.
  ~
  ~ Redistribution and use in source and/or binary forms, with or without
  ~ modification, must retain the above copyright notice and the following
  ~ disclaimer.
  ~
  ~ THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
  ~ "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
  ~ LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
  ~ A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
  ~ OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
  ~ SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
  ~ LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
  ~ DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
  ~ THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  ~ (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  ~ OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  -->
<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/iron-list/iron-list.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="./admin-vendor-menu.html">
<link rel="import" href="./admin-menu-dialog.html">

<dom-module id="admin-vendor-menus">
    <template>
        <style>
            #main-content {
                margin-left: 15%;
                margin-right: 15%;
                width: 70%;
                margin-top: 4%;
            }

            #header-table {
                display: flex;
                justify-content: space-between;
            }

            .paper-checkbox {
                align-self: flex-end;
                margin-bottom: 4px;
            }

            iron-list {
                --iron-list-items-container: {
                    width: 100%;
                    border-bottom: 1px solid #ddd;
                };
            }

            div[role="listbox"] {
                border: 1px solid #e5e5e5;
            }

            paper-item {
                width: 100%;
            }

            .item {
                @apply --layout-horizontal;
                /*padding: 20px;*/
                background-color: white;
                bottom-border: 1px solid #ddd;
                cursor: pointer;
            }

            .pad {
                @apply --layout-flex;
                @apply --layout-vertical;
                font-size: 15px;
            }

            paper-item {
                font-size: 15px;
                padding: 0;
            }

            .non-select {
                -webkit-touch-callout: none; /* iOS Safari */
                -webkit-user-select: none; /* Safari */
                -khtml-user-select: none; /* Konqueror HTML */
                -moz-user-select: none; /* Firefox */
                -ms-user-select: none; /* Internet Explorer/Edge */
                user-select: none;
                /* Non-prefixed version, currently supported by Chrome and Opera */
            }

            paper-icon-button.add-vendor {
                --paper-icon-button: {
                    --iron-icon-fill-color: white;
                    background-color: #0085d3;
                    border-radius: 50px;
                    padding: 12px;
                    width: 50px;
                    height: 50px;
                    box-shadow: 2px 3px 10px rgba(0, 0, 0, 0.5);
                }
            }

            paper-checkbox {
                --paper-checkbox-unchecked-background-color: #f2f2f2;
                --paper-checkbox-checked-color: #0085d3;
            }

            paper-dialog.size-position {
                height: 100%;
                position: fixed;
                top: 40%;
                left: 50%;
                transform: translate(-57%, -50%);
            }

            paper-dropdown-menu {
                width: 100%;
            }

            #header-item {
                display: flex;
                background-color: #f2f2f2;
                font-weight: bolder;
                border: 1px solid #ddd;
                width: auto;
                height: 50px;
                align-items: center;
                padding: 0 2%;
            }

            .item-vendor {
                width: 25%;

            }

            .item-from {
                width: 25%
            }

            .item-to {
                width: 25%
            }

            .item-status {
                width: 25%;
            }

            .item-icon {
                width: 40px;
                height: 40px;
            }

            #fab {
                --paper-fab-speed-dial-background: #0085d3;
                --paper-fab-speed-dial-keyboard-focus-background: #0085d3;
                --paper-fab-speed-dial-position: fixed;
                --paper-fab-speed-dial-bottom: 15px;
                --paper-fab-speed-dial-right: 23px;
            }

            @media only screen and (max-width: 1024px) {
                #header-table {
                    margin: 0 1%;
                }

                #main-content {
                    margin: 4% auto;
                    width: 100%;
                }
            }

            @media only screen and (max-width: 680px) {
                #header-table {
                    justify-content: flex-end;
                }

                #title {
                    display: none;
                }

                iron-list {
                    --iron-list-items-container: {
                        margin: 0 auto;
                        width: 100%;
                    }
                }

                .item-vendor {
                    width: 30%;
                }

                .item-to {
                    width: 27%;
                }

                .item-status {
                    width: 10%;
                }

                .item-icon {
                    display: none;
                }
            }

            @media only screen and (max-width: 320px) {
                .item-vendor {
                    width: 32%;
                }

                .item-to {
                    width: 24%;
                }

                .item-from {
                    width: 24%;
                }
            }
        </style>

        <div id="main-content">
            <div id="header-table">
                <h1 id="title">Меню</h1>
                <paper-checkbox on-change="_getAllMenu" class="paper-checkbox">Архивные
                </paper-checkbox>
            </div>

            <div id="header-item">
                <div class="item-vendor">
                    Поставщик
                </div>
                <div class="item-from">
                    От
                </div>
                <div class="item-to">
                    До
                </div>
                <div class="item-status">
                    Статус
                </div>
                <div class="item-icon"></div>
            </div>
            <iron-list scroll-target="document" id="list" items="[[menu]]" as="item"
                       selection-enabled
                       multi-selection>
                <template>
                    <div class="non-select">
                        <div class="item">
                            <div class="pad">
                                <admin-vendor-menu menu="[[item]]"
                                                   on-vendor-menu-resize="_resize"></admin-vendor-menu>
                            </div>
                        </div>
                    </div>
                </template>
            </iron-list>
        </div>
        <paper-fab-speed-dial on-iron-overlay-opened="_openDialog" id="fab">
        </paper-fab-speed-dial>
    </template>
    <script>
        /**
         * admin-vendor-menus represents an expanding list of menus with dates for admin using.
         *
         * @customElement
         * @polymer
         */
        class AdminVendorMenus extends MealOrderAdminApp.ReduxMixin(Polymer.Element) {
            static get is() {
                return 'admin-vendor-menus';
            }

            static get properties() {
                return {
                    /**
                     * Menu for the date range.
                     *
                     * @typedef {Object} Menu the menu for the date range.
                     *
                     * @property {String} vendor a vendor name
                     *
                     * @typedef {Object} Date contains day, month, year
                     * @property {Number} day
                     * @property {Number} month
                     * @property {Number} year
                     *
                     * @typedef {Array} Categories contains the category name and dishes
                     * @typedef {Array} Dishes contains the dish title, price, quantity
                     * @property {String} title
                     * @property {String} price
                     * @property {String} quantity
                     */
                    menu: {
                        type: Array,
                        statePath: "currentMenu",
                    }
                }
            }

            static get actions() {
                return {
                    vendorMenu(properties) {
                        return {
                            type: MealOrderAdminApp.AdminActions.OPEN_MENU,
                            properties: properties
                        }
                    },
                    getActiveMenu() {
                        return {
                            type: MealOrderAdminApp.AdminActions.GET_ACTIVE_MENU,
                        }
                    },
                    getAllMenu() {
                        return {
                            type: MealOrderAdminApp.AdminActions.GET_ALL_MENU,
                        }
                    }
                }
            }

            _openDialog() {
                const properties = {};
                properties.tagName = MealOrderAdminApp.AdminMenuDialog.is;
                this.dispatch('vendorMenu', properties);
                this.$.fab.close();
            }

            _getAllMenu(e) {
                if (e.target.active) {
                    this.dispatch('getAllMenu');
                }
                else
                {
                    this.dispatch('getActiveMenu');
                }
            }

            _resize() {
                this.shadowRoot.querySelector("#list").notifyResize();
            }
        }

        window.customElements.define(AdminVendorMenus.is, AdminVendorMenus);
    </script>
</dom-module>
