<!--
  ~ Copyright 2018, TeamDev Ltd. All rights reserved.
  ~
  ~ Redistribution and use in source and/or binary forms, with or without
  ~ modification, must retain the above copyright notice and the following
  ~ disclaimer.
  ~
  ~ THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
  ~ "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
  ~ LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
  ~ A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
  ~ OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
  ~ SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
  ~ LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
  ~ DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
  ~ THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  ~ (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
  ~ OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  -->
<script>
    {

        const activeMenu = [
            {
                name: 'Пюре',
                dateStart: new Date("2018-03-05"),
                dateEnd: new Date("2018-03-25"),
                status: "Активно",
                categories: [{
                    categoryName: 'Первое блюдо', dishes: [
                        {title: 'Суп гречневый', price: 35},
                        {title: 'Солянка', price: 40},
                        {title: 'Суп гороховый', price: 140},
                        {title: 'Уха', price: 35},
                        {title: 'Суп-пюре грибной', price: 40}]
                }
                    , {
                        categoryName: 'Второе блюдо', dishes: [
                            {title: 'Утиные крылышки', price: 40},
                            {title: 'Куриные крылышки', price: 45}]
                    }
                ]
            },
            {
                name: 'Позитив',
                dateStart: new Date("2018-03-05"),
                dateEnd: new Date("2018-03-25"),
                status: "Активно",
                categories: [{
                    categoryName: 'Первое блюдо', dishes: [
                        {title: 'Суп сырный', price: 35},
                        {title: 'Суп с лапшой', price: 40},
                        {title: 'Борщ красный', price: 40},
                        {title: 'Борщ зеленый', price: 35}]
                }
                    , {
                        categoryName: 'Второе блюдо', dishes: [
                            {title: 'Стейк из лосося', price: 40},
                            {title: 'Стейк из говядины', price: 45}]
                    },
                    {
                        categoryName: 'Напитки', dishes: [
                            {title: 'Лимонад', price: 40}]
                    }
                ]
            }
        ];

        const allMenu = [
            {
                name: 'Пюре',
                dateStart: new Date("2018-03-05"),
                dateEnd: new Date("2018-03-25"),
                status: "Активно",
                categories: [{
                    categoryName: 'Первое блюдо', dishes: [
                        {title: 'Суп гречневый', price: 35},
                        {title: 'Солянка', price: 40},
                        {title: 'Суп гороховый', price: 140},
                        {title: 'Уха', price: 35},
                        {title: 'Суп-пюре грибной', price: 40}]
                }
                    , {
                        categoryName: 'Второе блюдо', dishes: [
                            {title: 'Утиные крылышки', price: 40},
                            {title: 'Куриные крылышки', price: 45}]
                    }
                ]
            },
            {
                name: 'Позитив',
                dateStart: new Date("2018-03-05"),
                dateEnd: new Date("2018-03-25"),
                status: "Активно",
                categories: [{
                    categoryName: 'Первое блюдо', dishes: [
                        {title: 'Суп сырный', price: 35},
                        {title: 'Суп с лапшой', price: 40},
                        {title: 'Борщ красный', price: 40},
                        {title: 'Борщ зеленый', price: 35}]
                }
                    , {
                        categoryName: 'Второе блюдо', dishes: [
                            {title: 'Стейк из лосося', price: 40},
                            {title: 'Стейк из говядины', price: 45}]
                    },
                    {
                        categoryName: 'Напитки', dishes: [
                            {title: 'Лимонад', price: 40}]
                    }
                ]
            },
            {
                name: 'Пюре',
                dateStart: new Date("2018-02-05"),
                dateEnd: new Date("2018-02-25"),
                status: "В архиве",
                categories: [{
                    categoryName: 'Первое блюдо', dishes: [
                        {title: 'Суп гречневый', price: 35},
                        {title: 'Солянка', price: 40},
                        {title: 'Суп гороховый', price: 140},
                        {title: 'Уха', price: 35},
                        {title: 'Суп-пюре грибной', price: 40}]
                }
                    , {
                        categoryName: 'Второе блюдо', dishes: [
                            {title: 'Утиные крылышки', price: 40},
                            {title: 'Куриные крылышки', price: 45}]
                    }
                ]
            },
            {
                name: 'Позитив',
                dateStart: new Date("2018-02-05"),
                dateEnd: new Date("2018-02-25"),
                status: "В архиве",
                categories: [{
                    categoryName: 'Первое блюдо', dishes: [
                        {title: 'Суп сырный', price: 35},
                        {title: 'Суп с лапшой', price: 40},
                        {title: 'Борщ красный', price: 40},
                        {title: 'Борщ зеленый', price: 35}]
                }
                    , {
                        categoryName: 'Второе блюдо', dishes: [
                            {title: 'Стейк из лосося', price: 40},
                            {title: 'Стейк из говядины', price: 45}]
                    },
                    {
                        categoryName: 'Напитки', dishes: [
                            {title: 'Лимонад', price: 40}]
                    }
                ]
            }
        ];

        const monthlySpendings = [{
            date: new Date("2018-05-01"),
            users: [
                {name: 'Женя Сидоров', amount: 1000},
                {name: 'Антон Сокол', amount: 2000},
                {name: 'Вова Бессонов', amount: 938},
                {name: 'Андрей Жданов', amount: 3567},
                {name: 'Яна Смешарикова', amount: 100}
            ]
        },
            {
                date: new Date("2018-06-01"),
                users: [
                    {name: 'Стив Джобс', amount: 100},
                    {name: 'Майкл Скофилд', amount: 200},
                    {name: 'Вова Бессонов', amount: 938},
                    {name: 'Андрей Жданов', amount: 3567},
                    {name: 'Яна Смешарикова', amount: 100}]
            }
        ];

        const allPurchaseOrders = [
            {
                id: 'Pure',
                title: 'Пюре',
                date: new Date("2018-05-03"),
                status: 'correct'
            }, {
                id: 'Pozitiv',
                title: 'Позитив',
                date: new Date("2018-05-03"),
                status: 'incorrect'
            },
            {
                id: 'Pure',
                title: 'Пюре',
                date: new Date("2018-05-02"),
                status: 'correct'
            }, {
                id: 'Pozitiv',
                title: 'Позитив',
                date: new Date("2018-05-02"),
                status: 'correct'
            }
        ];

        MealOrderAdminApp.initialState = {
            monthlySpendingsStartDate: new Date("2016-05-03"),
            serverTime: new Date("2018-05-03"),
            vendors: [
                {
                    title: 'Пюре',
                    phone: '050-12-45-876',
                    email: 'smashpotato@gmail.com',
                    deadline: '11:00'
                }, {
                    title: 'Позитив',
                    phone: '050-14-88-322',
                    email: 'Positiv@gmail.com',
                    deadline: '10:00'
                },
            ],
            currentMenu: activeMenu,
            monthlySpendings: {},
            purchaseOrders: [],
        };

        MealOrderAdminApp.reducer = (state, action) => {
            if (!state) {
                return MealOrderAdminApp.initialState;
            }
            switch (action.type) {
                case MealOrderAdminApp.AdminActions.OPEN_VENDOR_DIALOG: {
                    return Object.assign({}, state, {
                            currentDialog: action.properties
                        }
                    );
                }
                case MealOrderAdminApp.AdminActions.CLOSE_VENDOR_DIALOG: {
                    return Object.assign({}, state, {
                            currentDialog: {}
                        }
                    );
                }
                case MealOrderAdminApp.AdminActions.OPEN_MENU: {
                    return Object.assign({}, state, {
                            currentDialog: action.properties
                        }
                    );
                }
                case MealOrderAdminApp.AdminActions.CLOSE_MENU: {
                    return Object.assign({}, state, {
                            currentDialog: {}
                        }
                    );
                }
                case MealOrderAdminApp.AdminActions.ADD_VENDOR: {
                    return state;
                }
                case MealOrderAdminApp.AdminActions.REMOVE_VENDOR: {
                    return state;
                }
                case MealOrderAdminApp.AdminActions.GET_ACTIVE_MENU: {
                    return Object.assign({}, state, {
                            currentMenu: activeMenu
                        }
                    );
                }
                case MealOrderAdminApp.AdminActions.GET_ALL_MENU: {
                    return Object.assign({}, state, {
                            currentMenu: allMenu
                        }
                    );
                }
                case MealOrderAdminApp.AdminActions.GET_SELECTED_MONTHLY_SPENDINGS: {
                    const selectedMonthlySpendings = monthlySpendings.find(spending =>
                        (spending.date.getMonth() === action.date.getMonth()) &&
                        (spending.date.getFullYear() === action.date.getFullYear()));
                    return Object.assign({}, state, {
                            monthlySpendings: selectedMonthlySpendings
                        }
                    );
                }
                case MealOrderAdminApp.AdminActions.GET_SELECTED_ORDERS: {
                    const currentOrders = allPurchaseOrders.filter(order => order.date.getTime()  === action.date.getTime());
                    console.log(currentOrders);
                    return Object.assign({}, state, {
                            purchaseOrders: currentOrders
                        }
                    );
                }
                default :
                    return state;
            }
        }
    }
</script>
